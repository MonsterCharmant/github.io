function Visualizator(t,e,i){this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioCtx.createAnalyser(),this.source=this.audioCtx.createMediaElementSource(t),this.source.connect(this.analyser),this.analyser.connect(this.audioCtx.destination),this.analyser.fftSize=i,this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.canvasCtx=e.getContext("2d"),this.WIDTH=e.width,this.HEIGHT=e.height,this.audio=t,this.canvas=e}Visualizator.prototype.reset=function(t){this.analyser.fftSize=t,this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength)},Visualizator.prototype.looper=function(t,e,i){t.clearRect(0,0,e,i),t.fillStyle="rgb(200, 200, 200)",t.fillRect(0,0,e,i),t.lineWidth=2,t.strokeStyle="rgb(0, 0, 0)",t.beginPath();for(var a=1*e/this.bufferLength,r=0,s=0;s<this.bufferLength;s++){var n=this.dataArray[s]/128,o=n*i/2;0===s?t.moveTo(r,o):t.lineTo(r,o),r+=a}t.lineTo(e,i/2),t.stroke();for(var h,l=e/this.bufferLength*2.5,u=0,s=0;s<this.bufferLength;s++)h=this.dataArray[s]/2,t.fillStyle="rgb("+(h+100)+",50,50)",t.fillRect(u,i-h/2,l,h),u+=l+1},Visualizator.prototype.rander=function(t,e,i){t.clearRect(0,0,e,i),t.fillStyle="rgb(200, 200, 200)",t.fillRect(0,0,e,i),t.beginPath();for(var a,r=e/this.bufferLength*2.5,s=0,n=0;n<this.bufferLength;n++)a=this.dataArray[n]/2,t.fillStyle="rgb("+(a+100)+",50,50)",t.fillRect(s,i-a/2,r,a),s+=r+1},Visualizator.prototype.draw=function(){this.analyser.getByteTimeDomainData(this.dataArray),this.rander(this.canvasCtx,this.WIDTH,this.HEIGHT),this.looper(this.canvasCtx,this.WIDTH,this.HEIGHT);var t=this;this.drawVisual=requestAnimationFrame(function(){t.draw()})};var visualizator,create=function(){var t=document.getElementById("waves"),e=document.getElementById("source");console.log(t.width+"    "+t.height),visualizator=new Visualizator(e,t,1024),visualizator.draw()};create();var select=function(t){console.log(t),visualizator.reset(t)};